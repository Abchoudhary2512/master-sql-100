## 56. Categorize products as 'Expensive' (>$200), 'Moderate' ($50-$200), or 'Cheap' (<$50)

```sql
SELECT 
    product_name, 
    price,
    CASE 
        WHEN price > 200 THEN 'Expensive'
        WHEN price BETWEEN 50 AND 200 THEN 'Moderate'
        ELSE 'Cheap'
    END AS price_category
FROM Products
ORDER BY price DESC;
````

---

## 57. Flag orders as 'High Value' (>$500), 'Medium' ($100-$500), or 'Low' (<$100)

```sql
SELECT 
    order_id, 
    customer_id, 
    total_amount,
    CASE 
        WHEN total_amount > 500 THEN 'High Value'
        WHEN total_amount BETWEEN 100 AND 500 THEN 'Medium'
        ELSE 'Low'
    END AS order_category
FROM Orders
ORDER BY total_amount DESC;
```

---

## 58. Show customer segments based on number of orders: 'New' (1), 'Regular' (2-3), 'VIP' (4+)

```sql
WITH CustomerOrderCount AS (
    SELECT 
        c.customer_id, 
        c.first_name, 
        c.last_name, 
        COUNT(o.order_id) AS order_count
    FROM Customers c
    LEFT JOIN Orders o 
        ON c.customer_id = o.customer_id
    GROUP BY 
        c.customer_id, 
        c.first_name, 
        c.last_name
)
SELECT 
    customer_id, 
    first_name, 
    last_name, 
    order_count,
    CASE 
        WHEN order_count = 1 THEN 'New'
        WHEN order_count BETWEEN 2 AND 3 THEN 'Regular'
        WHEN order_count >= 4 THEN 'VIP'
        ELSE 'Inactive'
    END AS customer_segment
FROM CustomerOrderCount
ORDER BY order_count DESC;
```

---

## 59. Calculate success rate of payments per payment method

```sql
SELECT 
    payment_method,
    COUNT(*) AS total_payments,
    SUM(CASE WHEN payment_status = 'Completed' THEN 1 ELSE 0 END) AS successful_payments,
    ROUND(
        100.0 * SUM(CASE WHEN payment_status = 'Completed' THEN 1 ELSE 0 END) 
        / COUNT(*), 
        2
    ) AS success_rate
FROM Payments
GROUP BY payment_method
ORDER BY success_rate DESC;
```

---

## 60. Display order status with human-readable descriptions

```sql
SELECT 
    order_id, 
    status,
    CASE status
        WHEN 'Pending' THEN 'Order received, awaiting processing'
        WHEN 'Processing' THEN 'Order is being prepared'
        WHEN 'Shipped' THEN 'Order has been dispatched'
        WHEN 'Delivered' THEN 'Order delivered to customer'
        WHEN 'Cancelled' THEN 'Order was cancelled'
        ELSE 'Unknown status'
    END AS status_description
FROM Orders
LIMIT 10;
```

---

## 61. Classify products as 'In Stock' (>10), 'Low Stock' (1-10), or 'Out of Stock' (0)

```sql
SELECT 
    product_name, 
    stock,
    CASE 
        WHEN stock > 10 THEN 'In Stock'
        WHEN stock BETWEEN 1 AND 10 THEN 'Low Stock'
        ELSE 'Out of Stock'
    END AS stock_status
FROM Products
ORDER BY stock;
```

---

## 62. Show customer lifetime value with tier labels

```sql
SELECT 
    c.customer_id, 
    c.first_name, 
    c.last_name, 
    COALESCE(SUM(o.total_amount), 0) AS lifetime_value,
    CASE 
        WHEN COALESCE(SUM(o.total_amount), 0) > 1000 THEN 'Platinum'
        WHEN COALESCE(SUM(o.total_amount), 0) BETWEEN 500 AND 1000 THEN 'Gold'
        WHEN COALESCE(SUM(o.total_amount), 0) BETWEEN 100 AND 500 THEN 'Silver'
        ELSE 'Bronze'
    END AS customer_tier
FROM Customers c
LEFT JOIN Orders o 
    ON c.customer_id = o.customer_id 
   AND o.status = 'Delivered'
GROUP BY 
    c.customer_id, 
    c.first_name, 
    c.last_name
ORDER BY lifetime_value DESC;
```

---

## 63. Calculate month-over-month growth with growth indicators

```sql
WITH MonthlyRevenue AS (
    SELECT 
        DATE_FORMAT(order_date, '%Y-%m') AS month,
        SUM(total_amount) AS revenue
    FROM Orders
    WHERE status = 'Delivered'
    GROUP BY month
),
RevenueWithPrev AS (
    SELECT 
        month, 
        revenue,
        LAG(revenue) OVER (ORDER BY month) AS prev_month_revenue
    FROM MonthlyRevenue
)
SELECT 
    month, 
    revenue, 
    prev_month_revenue,
    CASE 
        WHEN prev_month_revenue IS NULL THEN 'N/A'
        WHEN revenue > prev_month_revenue THEN '↑ Growth'
        WHEN revenue < prev_month_revenue THEN '↓ Decline'
        ELSE '→ Stable'
    END AS growth_indicator,
    CASE 
        WHEN prev_month_revenue IS NOT NULL THEN 
            CONCAT(
                ROUND(
                    100.0 * (revenue - prev_month_revenue) 
                    / prev_month_revenue, 
                    2
                ), 
                '%'
            )
        ELSE 'N/A'
    END AS growth_percentage
FROM RevenueWithPrev;
```

---

## 64. Flag potentially fraudulent orders

```sql
SELECT 
    o.order_id, 
    o.customer_id, 
    o.total_amount, 
    o.status,
    COUNT(p.payment_id) AS payment_attempts,
    SUM(CASE WHEN p.payment_status = 'Failed' THEN 1 ELSE 0 END) AS failed_payments,
    CASE 
        WHEN COUNT(p.payment_id) >= 2 
             AND SUM(CASE WHEN p.payment_status = 'Failed' THEN 1 ELSE 0 END) >= 1
             AND o.total_amount > 500 
        THEN 'HIGH RISK'
        WHEN COUNT(p.payment_id) >= 2 
             AND SUM(CASE WHEN p.payment_status = 'Failed' THEN 1 ELSE 0 END) >= 1
        THEN 'MEDIUM RISK'
        WHEN o.status = 'Pending' 
             AND o.total_amount > 300 
        THEN 'LOW RISK'
        ELSE 'NORMAL'
    END AS fraud_flag
FROM Orders o
LEFT JOIN Payments p 
    ON o.order_id = p.order_id
GROUP BY 
    o.order_id, 
    o.customer_id, 
    o.total_amount, 
    o.status
HAVING fraud_flag != 'NORMAL'
ORDER BY fraud_flag;
```

---

## 65. Display inventory status with reorder recommendations

```sql
SELECT 
    product_id, 
    product_name, 
    category_id, 
    stock,
    CASE 
        WHEN stock = 0 THEN 'URGENT: Out of stock - Reorder immediately'
        WHEN stock <= 10 THEN 'WARNING: Low stock - Reorder soon'
        WHEN stock <= 20 THEN 'CAUTION: Stock running low - Monitor'
        ELSE 'OK: Sufficient stock'
    END AS reorder_recommendation,
    CASE 
        WHEN stock <= 20 THEN stock * 2
        ELSE NULL
    END AS recommended_reorder_quantity
FROM Products
ORDER BY stock;
```
