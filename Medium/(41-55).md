
## 41. Show order details with customer names

```sql
SELECT 
    o.order_id, 
    o.order_date, 
    o.total_amount, 
    c.first_name, 
    c.last_name, 
    c.email
FROM Orders o
JOIN Customers c 
    ON o.customer_id = c.customer_id
ORDER BY o.order_date DESC
LIMIT 10;
````

---

## 42. List all products with their category names

```sql
SELECT 
    p.product_id, 
    p.product_name, 
    p.price, 
    c.category_name
FROM Products p
JOIN Categories c 
    ON p.category_id = c.category_id
ORDER BY c.category_name, p.price DESC;
```

---

## 43. Display order items with product names and order dates

```sql
SELECT 
    oi.order_item_id, 
    o.order_id, 
    o.order_date, 
    p.product_name, 
    oi.quantity, 
    oi.price
FROM Order_Items oi
JOIN Orders o 
    ON oi.order_id = o.order_id
JOIN Products p 
    ON oi.product_id = p.product_id
ORDER BY o.order_date DESC
LIMIT 15;
```

---

## 44. Show customer names along with their shipping addresses

```sql
SELECT 
    c.first_name, 
    c.last_name, 
    a.address_line, 
    a.city, 
    a.state, 
    a.country, 
    a.postal_code
FROM Customers c
JOIN Addresses a 
    ON c.customer_id = a.customer_id
WHERE a.address_type = 'Shipping'
ORDER BY c.last_name, c.first_name;
```

---

## 45. List all orders with payment methods used

```sql
SELECT 
    o.order_id, 
    o.order_date, 
    o.total_amount, 
    p.payment_method, 
    p.payment_status
FROM Orders o
LEFT JOIN Payments p 
    ON o.order_id = p.order_id
ORDER BY o.order_date DESC
LIMIT 15;
```

---

## 46. Display product names and the total quantity ordered for each

```sql
SELECT 
    p.product_name, 
    COALESCE(SUM(oi.quantity), 0) AS total_ordered
FROM Products p
LEFT JOIN Order_Items oi 
    ON p.product_id = oi.product_id
GROUP BY p.product_name
ORDER BY total_ordered DESC;
```

---

## 47. Show customer emails and their order statuses

```sql
SELECT 
    c.email, 
    o.order_id, 
    o.status, 
    o.order_date
FROM Customers c
JOIN Orders o 
    ON c.customer_id = o.customer_id
ORDER BY c.email, o.order_date DESC;
```

---

## 48. List all payments with corresponding order IDs and customer names

```sql
SELECT 
    p.payment_id, 
    p.order_id, 
    p.amount, 
    p.payment_method, 
    p.payment_status,
    c.first_name, 
    c.last_name, 
    c.email
FROM Payments p
JOIN Orders o 
    ON p.order_id = o.order_id
JOIN Customers c 
    ON o.customer_id = c.customer_id
ORDER BY p.payment_date DESC
LIMIT 15;
```

---

## 49. Display products that have never been ordered

```sql
SELECT 
    p.product_id, 
    p.product_name, 
    p.price
FROM Products p
LEFT JOIN Order_Items oi 
    ON p.product_id = oi.product_id
WHERE oi.order_item_id IS NULL;
```

---

## 50. Show customers who have placed orders but haven't made successful payments

```sql
SELECT DISTINCT 
    c.customer_id, 
    c.first_name, 
    c.last_name, 
    c.email
FROM Customers c
JOIN Orders o 
    ON c.customer_id = o.customer_id
JOIN Payments p 
    ON o.order_id = p.order_id
WHERE p.payment_status != 'Completed'
ORDER BY c.last_name;
```

---

## 51. Find customers who have placed orders but have no successful payments

```sql
SELECT 
    c.customer_id, 
    c.first_name, 
    c.last_name, 
    c.email
FROM Customers c
WHERE EXISTS (
    SELECT 1 
    FROM Orders o 
    WHERE o.customer_id = c.customer_id
)
AND NOT EXISTS (
    SELECT 1 
    FROM Orders o 
    JOIN Payments p 
        ON o.order_id = p.order_id 
    WHERE o.customer_id = c.customer_id 
      AND p.payment_status = 'Completed'
);
```

---

## 52. List products that have been ordered more than their current stock

```sql
SELECT 
    p.product_id, 
    p.product_name, 
    p.stock, 
    SUM(oi.quantity) AS total_ordered
FROM Products p
JOIN Order_Items oi 
    ON p.product_id = oi.product_id
GROUP BY 
    p.product_id, 
    p.product_name, 
    p.stock
HAVING SUM(oi.quantity) > p.stock;
```

---

## 53. Show the most popular product in each category (by quantity sold)

```sql
WITH ProductSales AS (
    SELECT 
        p.category_id, 
        p.product_id, 
        p.product_name, 
        SUM(oi.quantity) AS total_sold,
        ROW_NUMBER() OVER (
            PARTITION BY p.category_id 
            ORDER BY SUM(oi.quantity) DESC
        ) AS rn
    FROM Products p
    LEFT JOIN Order_Items oi 
        ON p.product_id = oi.product_id
    GROUP BY 
        p.category_id, 
        p.product_id, 
        p.product_name
)
SELECT 
    c.category_name, 
    ps.product_name, 
    ps.total_sold
FROM ProductSales ps
JOIN Categories c 
    ON ps.category_id = c.category_id
WHERE ps.rn = 1 
  AND ps.total_sold IS NOT NULL
ORDER BY c.category_name;
```

---

## 54. Find customers who have both shipping and billing addresses in different cities

```sql
SELECT 
    c.customer_id, 
    c.first_name, 
    c.last_name,
    ship.city AS shipping_city, 
    bill.city AS billing_city
FROM Customers c
JOIN Addresses ship 
    ON c.customer_id = ship.customer_id 
   AND ship.address_type = 'Shipping'
JOIN Addresses bill 
    ON c.customer_id = bill.customer_id 
   AND bill.address_type = 'Billing'
WHERE ship.city != bill.city;
```

---

## 55. Display orders where the total amount doesn't match the sum of order items

```sql
SELECT 
    o.order_id, 
    o.total_amount AS order_total, 
    SUM(oi.quantity * oi.price) AS calculated_total
FROM Orders o
JOIN Order_Items oi 
    ON o.order_id = oi.order_id
GROUP BY 
    o.order_id, 
    o.total_amount
HAVING ABS(o.total_amount - SUM(oi.quantity * oi.price)) > 0.01;
```

---
