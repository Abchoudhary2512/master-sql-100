## 16. Count number of orders per status

```sql
SELECT status, COUNT(*) AS order_count 
FROM Orders 
GROUP BY status;
```

---

## 17. Calculate total revenue from all delivered orders

```sql
SELECT SUM(total_amount) AS total_revenue 
FROM Orders 
WHERE status = 'Delivered';
```

---

## 18. Find the average order value

```sql
SELECT ROUND(AVG(total_amount), 2) AS avg_order_value 
FROM Orders;
```

---

## 19. Count products in each category

```sql
SELECT c.category_name, COUNT(p.product_id) AS product_count
FROM Categories c
LEFT JOIN Products p ON c.category_id = p.category_id
GROUP BY c.category_name
ORDER BY product_count DESC;
```

---

## 20. Find the minimum and maximum product price in each category

```sql
SELECT c.category_name, 
       MIN(p.price) AS min_price, 
       MAX(p.price) AS max_price
FROM Categories c
LEFT JOIN Products p ON c.category_id = p.category_id
GROUP BY c.category_name
ORDER BY c.category_name;
```

---

## 21. Calculate total quantity sold for each product

```sql
SELECT p.product_name, SUM(oi.quantity) AS total_quantity_sold
FROM Products p
LEFT JOIN Order_Items oi ON p.product_id = oi.product_id
GROUP BY p.product_name
ORDER BY total_quantity_sold DESC;
```

---

## 22. Count number of customers who joined each month

```sql
SELECT DATE_FORMAT(created_at, '%Y-%m') AS join_month, 
       COUNT(*) AS customer_count
FROM Customers
GROUP BY join_month
ORDER BY join_month;
```

---

## 23. Find total sales per payment method

```sql
SELECT payment_method, SUM(amount) AS total_sales
FROM Payments
WHERE payment_status = 'Completed'
GROUP BY payment_method
ORDER BY total_sales DESC;
```

---

## 24. Determine average product price by category

```sql
SELECT c.category_name, ROUND(AVG(p.price), 2) AS avg_price
FROM Categories c
LEFT JOIN Products p ON c.category_id = p.category_id
GROUP BY c.category_name
ORDER BY avg_price DESC;
```

---

## 25. Count orders per customer and show only those with more than 1 order

```sql
SELECT c.customer_id, c.first_name, c.last_name, COUNT(o.order_id) AS order_count
FROM Customers c
JOIN Orders o ON c.customer_id = o.customer_id
GROUP BY c.customer_id, c.first_name, c.last_name
HAVING COUNT(o.order_id) > 1
ORDER BY order_count DESC;
```

---

## 26. Calculate total revenue per month

```sql
SELECT DATE_FORMAT(order_date, '%Y-%m') AS month, 
       SUM(total_amount) AS monthly_revenue
FROM Orders
WHERE status = 'Delivered'
GROUP BY month
ORDER BY month;
```

---

## 27. Find the most popular shipping city (based on order count)

```sql
SELECT a.city, COUNT(o.order_id) AS order_count
FROM Orders o
JOIN Addresses a ON o.shipping_address_id = a.address_id
GROUP BY a.city
ORDER BY order_count DESC
LIMIT 5;
```

---

## 28. Show categories that have more than 3 products

```sql
SELECT c.category_name, COUNT(p.product_id) AS product_count
FROM Categories c
JOIN Products p ON c.category_id = p.category_id
GROUP BY c.category_name
HAVING COUNT(p.product_id) > 3;
```

---

## 29. Calculate total stock value (price Ã— stock) per category

```sql
SELECT c.category_name, 
       SUM(p.price * p.stock) AS total_stock_value
FROM Categories c
JOIN Products p ON c.category_id = p.category_id
GROUP BY c.category_name
ORDER BY total_stock_value DESC;
```

---

## 30. Find customers who have spent more than $500 total

```sql
SELECT c.customer_id, c.first_name, c.last_name, SUM(o.total_amount) AS total_spent
FROM Customers c
JOIN Orders o ON c.customer_id = o.customer_id
WHERE o.status = 'Delivered'
GROUP BY c.customer_id, c.first_name, c.last_name
HAVING SUM(o.total_amount) > 500
ORDER BY total_spent DESC;
```

